<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lhiot.mall.wholesale.goods.mapper.PlateGoodsMapper">
	<sql id="goodsStandardColumn">
		t1.id ,t1.goods_id as goodsId, t1.bar_code as barCode,t1.weight,t1.unit_code as unitCode,
		t1.standard, t1.price, t1.if_vaild as ifVaild,t1.hd_sku_id as hdSkuId, t1.standard_desc as standardDesc
	</sql>
	
	<sql id="goodsColumn">
		t2.id,t1.goods_code as goodsCode,t2.goods_name as goodsName,t2.category_id as categoryId,
		t2.goods_image as goodsImage,t2.base_bar as baseBar,t2.base_unit as baseUnit,t2.stock_limit as stockLimit,
		t2.goods_des as goodsDes,t2.goods_images as goodsImages,t2.other_image as otherImage
	</sql>
	
	<sql id="unitColumn">
		t3.unit_code as GoodsUnitCode,t3.unit_name as GoodsUnitName
	</sql>
	
	<!-- lynn后台管理 新增2018/4/19 -->
	<insert id="insertInbatch" parameterType="com.lhiot.mall.wholesale.goods.domain.PlateGoods">
		insert into t_whs_plate_goods (plate_id,goods_standard_id)
		values
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.plateId},#{item.goodsStandardId})
		</foreach>
	</insert>
	
	<!-- lynn后台管理 删除2018/4/19 -->
	<delete id="removeInbatch" parameterType="java.util.List">
		delete from t_whs_plate_goods where id in
		<foreach collection="list" item = "item" open="(" separator="," close=")">
			#{item}
		</foreach>
	</delete>
	
	<!-- lynn后台管理 根据id查询2018/4/19 -->
	<select id="select" parameterType="Long" resultType="com.lhiot.mall.wholesale.goods.domain.GoodsStandard">
		select <include refid="goodsStandardColumn"/>, <include refid="goodsColumn"/>,<include refid="unitColumn"/>
		from t_whs_plate_goods t4
		left join t_whs_goods_standard t1 on t4.goods_standard_id = t1.id
		left join t_whs_goods t2 on t1.goods_id = t2.id
		left join t_whs_goods_unit t3 on t1.unit_code = t3.id
		where t4.id = #{0}
	</select>
	
	<!-- lynn后台管理 查询所有用作下拉框2018/4/19 -->
	<select id="search" resultType="com.lhiot.mall.wholesale.goods.domain.GoodsStandard">
		select <include refid="goodsStandardColumn"/>, <include refid="goodsColumn"/>,<include refid="unitColumn"/>
		from t_whs_plate_goods t4
		left join t_whs_goods_standard t1 on t4.goods_standard_id = t1.id
		left join t_whs_goods t2 on t1.goods_id = t2.id
		left join t_whs_goods_unit t3 on t1.unit_code = t3.id
	</select>
	
	<!-- lynn后台管理 分页查询2018/4/19 -->
	<select id="pageQueryCount" parameterType="map" resultType="Integer">
		select count(id) 
		from t_whs_plate_goods t4
		left join t_whs_goods_standard t1 on t4.goods_standard_id = t1.id
		left join t_whs_goods t2 on t1.goods_id = t2.id
		left join t_whs_goods_unit t3 on t1.unit_code = t3.id
		<trim prefix="where" prefixOverrides="and">
			<if test="goodsName != null and goodsName != ''">
				and t2.goods_name = #{goodsName}
			</if>
			<if test="goodsCode != null and goodsCode != ''">
				and t2.goods_code =#{goodsCode}
			</if>
		</trim>
	</select>
	
	<!-- lynn后台管理 分页查询2018/4/19 -->
	<select id="pageQuery" parameterType="map" resultType="com.lhiot.mall.wholesale.goods.domain.GoodsStandard">
		select <include refid="goodsStandardColumn"/>, <include refid="goodsColumn"/>,<include refid="unitColumn"/> 
		from t_whs_plate_goods t4
		left join t_whs_goods_standard t1 on t4.goods_standard_id = t1.id
		left join t_whs_goods t2 on t1.goods_id = t2.id
		left join t_whs_goods_unit t3 on t1.unit_code = t3.id
		<trim prefix="where" prefixOverrides="and">
			<if test="goodsName != null and goodsName != ''">
				and t2.goods_name = #{goodsName}
			</if>
			<if test="goodsCode != null and goodsCode != ''">
				and t2.goods_code =#{goodsCode}
			</if>
		</trim>
		<include refid="common.pager"></include>
	</select>
</mapper>